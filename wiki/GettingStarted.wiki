#summary How to start work with ajdmserver
=Installing dmServer=
	Please refer to http://static.springsource.com/projects/dm-server/1.0.x/getting-started/html/ch02.html
----
=Installing Eclipse tools=
	Please refer to http://static.springsource.com/projects/dm-server/1.0.x/getting-started/html/ch02s04.html
----
=Installing libraries =
	Copy (*in order like below*)
		* `asterisk-java-0.3.1.jar`
		* `AgiDmServerLib.jar`
	To directory 
		`<dm_installation_path>`\repository\libraries\usr\

----
=Deploying ajdmserver=
ajdmserver.jar exposes two services:
   * MappingStrategy
   * ServerManager

Mapping strategy is a service that implements  [http://asterisk-java.org/latest/apidocs/org/asteriskjava/fastagi/MappingStrategy.html org.asteriskjava.fastagi.MappingStrategy] interface. It discovers and obtains AgiScripts. Each AgiServer has its own MappingStrategy instance. 

ServerManager is a service that runs and stops AgiServers instances. It can be use to list servers and its properties.

To install services deploy ajdmserver.jar in dmSpringSOurce Server web interface (if server is installed on localhost admin interface is located under link http://localhost:8080/admin)
       
----
=Deploying XMLConfServerStarter=
ServerStarter is responsible for creating AgiServer instances defined in simple XML file on dmServer startup. 
XML files with servers definitions must be located at:
  *  /etc/agi-servers.xml under Unix systems
  *  c:\agi-servers.xml under Windows systems
Before deploying this bundle you have to create config file to have your agi server (or servers) working. Example of such file can be found [ServerStarterXMLConfFile here].

To install this bundle deploy it in web admin interface.
*IMPORTANT* Deploy of this bundle must be done after deploying ajdmserver.jar file
----
=Configuring Eclipse to work with dmServer==
       * Bring up the Servers view: Window → Show View → Other → Server → Servers.
       * Bring up a "New Server" dialog: Right click in Servers view and select New → Server.
       * select "SpringSource dm Server v1.0" under the SpringSource category, give it an appropriate name, and click "Next".
        * In the "SpringSource AP installation directory" field, locate the springsource-dm-server-1.0.1.RELEASE directory 
        * Select "Finish".

(Copy pasted from [http://maniagnosis.blogspot.com/2008/09/developing-for-springsource-dm-server.html])
----
=First script=
        * Bring up 'New' dialog clicking File -> New -> Other
        * Select 'Bundle Project'
        * Give name to your project and click finish
        * In Servers view right click on your dmServer and select 'Add/Remove Project'
        * Add new created Bundle Project to server's repository
        * Next you have to add asterisk java library from dmServer repository: click on MANIFRST.MF and add asterisk-java bundle to class path
        * create class that implements AgiScript interface - implement call control logic
        * create folder 'spring' in META-INF folde
        * create new xml file inside spring folder
        * your xml file should look like exmaple:
{{{

<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:osgi="http://www.springframework.org/schema/osgi"
        xsi:schemaLocation="http://www.springframework.org/schema/beans  
       http://www.springframework.org/schema/beans/spring-beans.xsd  
       http://www.springframework.org/schema/osgi  
       http://www.springframework.org/schema/osgi/spring-osgi.xsd">


        <osgi:service id="YourScriptName" interface="org.asteriskjava.fastagi.AgiScript">
                <osgi:service-properties>
                        <entry key="agiRequestPattern" value="request_pattern" />
                        <entry key="agiDomain" value="domain1" />
                </osgi:service-properties>
                <bean id="your script bean name" class="fqdn of your script class" />
        </osgi:service>
</beans>

}}}
Line  
{{{
 <entry key="agiDomain" value="domain1" />
}}}
Defines FastAgi server's domain 